{
  "version": 3,
  "sources": ["../../../src/generateUrl.ts"],
  "sourcesContent": ["import { APIGatewayProxyHandlerV2 } from \"aws-lambda\";\nimport { S3Client, PutObjectCommand } from \"@aws-sdk/client-s3\";\nimport { getSignedUrl } from \"@aws-sdk/s3-request-presigner\";\n\nconst s3 = new S3Client({ region: \"us-east-1\" });\n\nexport const handler: APIGatewayProxyHandlerV2 = async (event) => {\n  try {\n    console.log(\"QUERY PARAMS\", event.queryStringParameters);\n\n    const bucket = process.env.S3_BUCKET!;\n    const fileName = event.queryStringParameters?.fileName;\n    const fileType = event.queryStringParameters?.fileType;\n\n    if (!fileName || !fileType) {\n      return {\n        statusCode: 400,\n        headers: {\n          \"Access-Control-Allow-Origin\": \"*\",\n        },\n        body: JSON.stringify({ error: \"Missing fileName or fileType\" }),\n      };\n    }\n\n    const key = `uploads/${Date.now()}_${fileName}`;\n\n    const url = await getSignedUrl(\n      s3,\n      new PutObjectCommand({\n        Bucket: bucket,\n        Key: key,\n        ContentType: fileType,\n      }),\n      { expiresIn: 60 }\n    );\n\n    return {\n      statusCode: 200,\n      headers: {\n        \"Access-Control-Allow-Origin\": \"*\",\n      },\n      body: JSON.stringify({ url, key }),\n    };\n  } catch (error) {\n    console.error(\"Error generating signed URL:\", error);\n    return {\n      statusCode: 500,\n      headers: {\n        \"Access-Control-Allow-Origin\": \"*\",\n      },\n      body: JSON.stringify({ error: \"Failed to generate signed URL\" }),\n    };\n  }\n};\n"],
  "mappings": ";AACA,SAAS,UAAU,wBAAwB;AAC3C,SAAS,oBAAoB;AAE7B,IAAM,KAAK,IAAI,SAAS,EAAE,QAAQ,YAAY,CAAC;AAExC,IAAM,UAAoC,OAAO,UAAU;AAChE,MAAI;AACF,YAAQ,IAAI,gBAAgB,MAAM,qBAAqB;AAEvD,UAAM,SAAS,QAAQ,IAAI;AAC3B,UAAM,WAAW,MAAM,uBAAuB;AAC9C,UAAM,WAAW,MAAM,uBAAuB;AAE9C,QAAI,CAAC,YAAY,CAAC,UAAU;AAC1B,aAAO;AAAA,QACL,YAAY;AAAA,QACZ,SAAS;AAAA,UACP,+BAA+B;AAAA,QACjC;AAAA,QACA,MAAM,KAAK,UAAU,EAAE,OAAO,+BAA+B,CAAC;AAAA,MAChE;AAAA,IACF;AAEA,UAAM,MAAM,WAAW,KAAK,IAAI,CAAC,IAAI,QAAQ;AAE7C,UAAM,MAAM,MAAM;AAAA,MAChB;AAAA,MACA,IAAI,iBAAiB;AAAA,QACnB,QAAQ;AAAA,QACR,KAAK;AAAA,QACL,aAAa;AAAA,MACf,CAAC;AAAA,MACD,EAAE,WAAW,GAAG;AAAA,IAClB;AAEA,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU,EAAE,KAAK,IAAI,CAAC;AAAA,IACnC;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,gCAAgC,KAAK;AACnD,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU,EAAE,OAAO,gCAAgC,CAAC;AAAA,IACjE;AAAA,EACF;AACF;",
  "names": []
}
